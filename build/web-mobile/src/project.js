require=function t(o,n,i){function r(c,a){if(!n[c]){if(!o[c]){var s="function"==typeof require&&require;if(!a&&s)return s(c,!0);if(e)return e(c,!0);var l=new Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[c]={exports:{}};o[c][0].call(h.exports,function(t){var n=o[c][1][t];return r(n||t)},h,h.exports,t,o,n,i)}return n[c].exports}for(var e="function"==typeof require&&require,c=0;c<i.length;c++)r(i[c]);return r}({Game2:[function(t,o,n){"use strict";cc._RF.push(o,"78da29ONVVGYpDXBTrwqJtB","Game2");var i=t("./common/Global");cc.Class({extends:cc.Component,properties:{box:{default:null,type:cc.Prefab},picArrs:{default:[],type:[cc.SpriteFrame]},refreshBtn:{default:null,type:cc.Button},backBtn:{default:null,type:cc.Button}},ctor:function(){this.arr=[],this._boxArrs=[],this.selectId=null,this.clickId=null,this.pass=!1,this._lineNodes=[],this.row=i._type,this.col=i._type},onLoad:function(){var t=this;this.gameStart(),this.refreshBtn.node.on(cc.Node.EventType.TOUCH_END,function(o){t.gameStart()}),this.backBtn.node.on(cc.Node.EventType.TOUCH_END,function(t){cc.director.loadScene("Began")})},gameStart:function(){var t=this;this._boxArrs.length>0&&(this._boxArrs.forEach(function(t){cc.isValid(t)&&t.destroy()}),this._boxArrs=[]);var o=this.picArrs.slice(0,this.row),n=cc.director.getWinSize().width,i=this.getSortArrs(o,this.row,this.col);if(0!==i.length){this._boxWidth=500/this.col;for(var r=0;r<this.row+2;r++)for(var e=0;e<this.col+2;e++){var c={point:[e,r],box:null,val:null,pos:null,index:e+r*(this.col+2)},a=-n/2+(n-this._boxWidth*this.col)/2+(e-.5)*this._boxWidth,s=270-(r-1)*this._boxWidth;if(c.pos=cc.p(a,s),0!==r&&0!==e&&r!==this.col+1&&e!==this.row+1){var l=e-1+(r-1)*this.col;c.val=i[l].type;var h=cc.instantiate(this.box);this.node.addChild(h);var u=new cc.Node;u.addComponent(cc.Sprite).spriteFrame=i[l].texture,h.addChild(u),h.setScale(this._boxWidth/h.width),h.setPosition(c.pos),h.setTag(c.index),c.box=h,this._boxArrs.push(h),h.on(cc.Node.EventType.TOUCH_END,function(o){var n=o.currentTarget.getTag();if(t.arr[n].box)if(t.selectId){if(n===t.selectId)return;t.clickId=n;var i=t.checkAction(t.arr[t.selectId],t.arr[n],!0);if(0==i.length)t.selectId=null;else{for(var r=0;r<i.length-1;r++)t.drawLine(i[r],i[r+1]);t.scheduleOnce(function(){t._lineNodes.forEach(function(t){t.clear()}),t.clickPass()},.3)}}else t.selectId=n,t.pass=!1,cc.log("selectId = ",t.arr[n].val)})}this.arr[c.index]=c}this.checkEnable()}},checkAction:function(t,o,n){var i=this;if(!this.checkDoublePass(t,o)&&n)return[];if((t.point[0]===o.point[0]||t.point[1]===o.point[1])&&this.checkDoublePoint(t,o))return[t,o];var r=this.getPointAround(t),e=this.getPointAround(o),c=null,a=!1;if(r.forEach(function(t){a||e.forEach(function(o){if(t.index===o.index)return c=t,void(a=!0)})}),c)return[t,c,o];var s=[];return r.forEach(function(n){i.pass||e.forEach(function(r){n.point[0]!==r.point[0]&&n.point[1]!==r.point[1]||!i.checkDoublePoint(n,r)||(i.pass=!0,s=[t,n,r,o])})}),s},checkDoublePass:function(t,o){return t.val===o.val},checkDoublePoint:function(t,o){if(t.point[0]===o.point[0])if(t.point[1]>o.point[1])for(var n=o.point[1]+1;n<t.point[1];n++){var i=t.point[0]+n*(this.row+2);if(this.arr[i].val)return!1}else for(var r=o.point[1]-1;r>t.point[1];r--){var e=t.point[0]+r*(this.row+2);if(this.arr[e].val)return!1}else if(t.point[0]>o.point[0])for(var c=o.point[0]+1;c<t.point[0];c++){var a=c+o.point[1]*(this.row+2);if(this.arr[a].val)return!1}else for(var s=o.point[0]-1;s>t.point[0];s--){var l=s+o.point[1]*(this.row+2);if(this.arr[l].val)return!1}return!0},getPointAround:function(t){for(var o=[],n=t.point[1]-1;n>=0;n--){var i=t.point[0]+n*(this.col+2);if(this.arr[i].val)break;o.push(this.arr[i])}for(var r=t.point[0]+1;r<this.col+2;r++){var e=r+t.point[1]*(this.col+2);if(this.arr[e].val)break;o.push(this.arr[e])}for(var c=t.point[1]+1;c<this.row+2;c++){var a=t.point[0]+c*(this.col+2);if(this.arr[a].val)break;o.push(this.arr[a])}for(var s=t.point[0]-1;s>=0;s--){var l=s+t.point[1]*(this.col+2);if(this.arr[l].val)break;o.push(this.arr[l])}return o},clickPass:function(){[this.arr[this.selectId],this.arr[this.clickId]].map(function(t){t.box.destroy(),t.box=null,t.val=null}),this.selectId=null,this.checkGameSuccess()},checkGameSuccess:function(){this.arr.every(function(t){return!t.box})?cc.director.loadScene("Pass"):this.checkEnable()},drawLine:function(t,o){var n=cc.director.getWinSize(),i=new cc.DrawNode;cc.Canvas.instance.node.parent._sgNode.addChild(i),i.drawSegment(cc.p(t.pos.x+n.width/2,t.pos.y+n.height/2),cc.p(o.pos.x+n.width/2,o.pos.y+n.height/2),5,cc.color(265,1,0,255)),this._lineNodes.push(i)},getSortArrs:function(t,o,n){var i=[],r=o*n/t.length;if(r.toString().indexOf(".")>=0||r%2!=0)return cc.log("随机图片的个数不平均"),i;for(var e=0;e<t.length;e++)for(var c=0;c<r;c++)i.push({type:e+1,texture:t[e]});return i.sort(function(t,o){return cc.random0To1()>.5?1:-1}),i},checkEnable:function(){0==this.findTip().length&&(cc.log("无解!!! 替换位置"),this.updateLayout())},findTip:function(){var t=this,o=[];this.arr.forEach(function(t){t.box&&(o[t.val]?o[t.val].push(t):o[t.val]=[t])});var n=!1,i=[];return o.forEach(function(o){if(!n)for(var r=0;r<o.length&&!n;r++)for(var e=r+1;e<o.length&&!n;e++){var c=t.checkAction(o[r],o[e],!0);c.length>0&&(n=!0,i=c)}}),i},updateLayout:function(){var t=this,o=!1;this.arr.forEach(function(n){if(!o&&n.box){var i=void 0,r=void 0;t.arr.forEach(function(o){if(o.box){i||n.val!==o.val||n.index===o.index||(i=o);var e=t.checkAction(n,o,!1);!r&&n.val!==o.val&&e.length>0&&(r=o)}}),i&&r&&(t.updateDoublePoint(i,r),o=!0)}})},updateDoublePoint:function(t,o){var n={val:t.val,box:t.box};t.val=o.val,t.box=o.box,o.val=n.val,o.box=n.box,[t,o].map(function(t){t.box.setTag(t.index),t.box.runAction(cc.moveTo(.3,t.pos))})}}),cc._RF.pop()},{"./common/Global":"Global"}],Game:[function(t,o,n){"use strict";cc._RF.push(o,"280c3rsZJJKnZ9RqbALVwtK","Game"),cc.Class({extends:cc.Component,properties:{box:{default:null,type:cc.Prefab},arr:{default:[]},row:4,col:4,selectId:null,clickId:null,pass:!1,passInfos:[],_lineNodes:[]},onLoad:function(){var t=[1,2,3,4],o=(this.row,this.col,cc.director.getWinSize().width),n=this.node.getChildByName("Background"),i=this.getSortArrs(t,this.row,this.col);if(0!==i.length){this._boxWidth=500/this.col;for(var r=this,e=0;e<this.row+2;e++)for(var c=0;c<this.col+2;c++){var a={point:[c,e],box:null,val:null,pos:null,index:c+e*(this.row+2)},s=(o-500)/2+(c-1)*this._boxWidth,l=750-(e-1)*this._boxWidth;if(a.pos=cc.p(s,l),0!==e&&0!==c&&e!==this.col+1&&c!==this.row+1){var h=c-1+(e-1)*this.row;a.val=i[h];var u=cc.instantiate(this.box);n.addChild(u),u.anchorX=0,u.anchorY=0;var f=u.getChildByName("label");f.setPosition(cc.p(u.width/2,u.height/2)),f.getComponent(cc.Label).string=a.val,u.setScale(this._boxWidth/u.width),u.setPosition(a.pos),u.setTag(a.index),a.box=u,u.on(cc.Node.EventType.TOUCH_END,function(t){t.currentTarget.getChildByName("label").getComponent(cc.Label).string;var o=t.currentTarget.getTag();if(r.arr[o].box)if(r.selectId){if(o===r.selectId)return;r.clickId=o,r.checkAction(r.arr[r.selectId],r.arr[o],0,[])}else r.selectId=o,r.pass=!1,cc.log("selectId = ",r.arr[o].val)})}this.arr.push(a)}}},checkAction:function(t,o,n,i){var r=i.slice();if(t.point[0]!==o.point[0]&&t.point[1]!==o.point[1]||!this.checkDoublePoint(t,o)){if(2!==n){r.push(t);var e=[],c=this;this.arr.forEach(function(o,n){(o.point[0]===t.point[0]&&n!==t.index&&!o.val||o.point[1]===t.point[1]&&n!==t.index&&!o.val)&&e.push(o)}),e=e.filter(function(o){if(c.checkDoublePoint(o,t))return o}),n++,e.forEach(function(t){c.checkAction(t,o,n,r)}),1===n&&(cc.log("所有情况跑完"),this.findShortPath())}}else this.checkDoublePass(this.arr[this.selectId],this.arr[this.clickId])?(r.push(t),r.push(o),this.addPassInfo(r),0==n&&this.findShortPath()):0===n&&(this.selectId=null)},checkDoublePass:function(t,o){return t.val===o.val},checkDoublePoint:function(t,o){if(t.point[0]===o.point[0])if(t.point[1]>o.point[1])for(n=o.point[1]+1;n<t.point[1];n++){i=t.point[0]+n*(this.row+2);if(this.arr[i].val)return!1}else for(n=o.point[1]-1;n>t.point[1];n--){i=t.point[0]+n*(this.row+2);if(this.arr[i].val)return!1}else if(t.point[0]>o.point[0])for(n=o.point[0]+1;n<t.point[0];n++){i=n+o.point[1]*(this.row+2);if(this.arr[i].val)return!1}else for(var n=o.point[0]-1;n>t.point[0];n--){var i=n+o.point[1]*(this.row+2);if(this.arr[i].val)return!1}return!0},addPassInfo:function(t){this.passInfos.push(t)},findShortPath:function(){if(this.passInfos.length<=0)return cc.log("没有符合条件!!!"),void(this.selectId=null);var t=null,o=0;this.passInfos.forEach(function(n){for(var i=0,r=1;r<n.length;r++){var e=n[r].point,c=n[r-1].point;e[0]===c[0]?i+=Math.abs(e[1]-c[1]):i+=Math.abs(e[0]-c[0])}(i<o||!o)&&(t=n,o=i)});for(var n=0;n<t.length-1;n++)this.drawLine(t[n],t[n+1]);this.scheduleOnce(function(){this._lineNodes.forEach(function(t){t.clear()}),this.gamePass()},.5)},gamePass:function(){var t=this.arr[this.selectId],o=this.arr[this.clickId];t.box.destroy(),t.box=null,t.val=null,o.box.destroy(),o.box=null,o.val=null,this.selectId=null,this.pass=!0,this.passInfos=[],this.checkGameSuccess()},checkGameSuccess:function(){this.arr.every(function(t){return!t.box})&&(cc.log("通关"),cc.director.loadScene("Pass"))},drawLine:function(t,o){var n=new cc.DrawNode;cc.Canvas.instance.node.parent._sgNode.addChild(n,100),n.drawSegment(cc.p(t.pos.x+this._boxWidth/2+5,t.pos.y+this._boxWidth/2),cc.p(o.pos.x+this._boxWidth/2+5,o.pos.y+this._boxWidth/2),5,cc.color(265,1,0,255)),this._lineNodes.push(n)},getSortArrs:function(t,o,n){var i=[],r=o*n/t.length;if(r.toString().indexOf(".")>=0||r%2!=0)return cc.log("随机图片的个数不平均"),i;for(var e=0;e<t.length;e++)for(var c=0;c<r;c++)i.push(t[e]);return i.sort(function(t,o){return cc.random0To1()>.5?1:-1}),i},update:function(t){}}),cc._RF.pop()},{}],Global:[function(t,o,n){"use strict";cc._RF.push(o,"a0d74w6/RlD6pPIwyfKLFp/","Global"),o.exports={_type:4},cc._RF.pop()},{}],btnClick:[function(t,o,n){"use strict";cc._RF.push(o,"b2cdcGTZK5G54EVIt5boJDs","btnClick");var i=t("./common/Global");cc.Class({extends:cc.Component,properties:{btnMp3:{default:null,url:cc.AudioClip}},start:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(o){t.btnClick()},this)},btnClick:function(t){cc.audioEngine.playEffect(this.btnMp3)},click:function(t){cc.director.loadScene("Change")},typeClick:function(t,o){i._type=+o,cc.director.loadScene("Game")},gobackClick:function(){cc.director.loadScene("Change")},changeGameClick:function(t,o){this.btnClick(),"lianliankan"===o?cc.director.loadScene("Began"):"huarongdao"===o&&cc.director.loadScene("HuaGame")}}),cc._RF.pop()},{"./common/Global":"Global"}],change:[function(t,o,n){"use strict";cc._RF.push(o,"bfcbaZM+WBK4IM5fbWkzsfL","change"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.director.preloadScene("Began"),cc.director.preloadScene("HuaGame")},start:function(){}}),cc._RF.pop()},{}],huaGame:[function(t,o,n){"use strict";cc._RF.push(o,"c3c04KhgWdFG54kGnB/L2Jt","huaGame"),cc.Class({extends:cc.Component,properties:{box:{default:null,type:cc.Prefab},arr:{default:[]}},ctor:function(){this.col=4,this.row=4},onLoad:function(){for(var t=this,o=this.row,n=this.col,i=o*n,r=this._getSortArrs(i,2e3),e=500/n,c=0;c<i;c++){var a=(c%n-n/2+.5)*e,s=200-Math.floor(c/n)*e;this.arr[c]={point:[c%n,Math.floor(c/n)],val:null,box:null,pos:cc.p(a,s)}}for(var l=0;l<i-1;l++){var h=cc.instantiate(this.box);this.node.addChild(h),h.getChildByName("label").getComponent(cc.Label).string=r[l],h.setScale(e/h.width),this.arr[l].val=r[l],this.arr[l].box=h,h.setPosition(this.arr[l].pos),h.on("mousedown",function(i){var r=+i.currentTarget.getChildByName("label").getComponent(cc.Label).string,e=void 0,c=void 0;t.arr.forEach(function(t,o){if(r===t.val)return e=t,void(c=o)});var a=[[e.point[0],e.point[1]-1],[e.point[0]+1,e.point[1]],[e.point[0],e.point[1]+1],[e.point[0]-1,e.point[1]]],s=c,l=void 0;a.forEach(function(i){var r=i[0]+i[1]*n;0<=i[0]&&i[0]<n&&0<=i[1]&&i[1]<o&&!t.arr[r].val&&(l=r)}),l>=0&&t.runAction(s,l)})}},runAction:function(t,o){var n=this.arr[o],i=this.arr[t];n.box=i.box,n.val=i.val,n.box.runAction(cc.moveTo(.1,n.pos)),this.arr[t].val=null,this.arr[t].box=null,this.checkPassGame()&&(cc.log("YOU WIN!! GAME OVER!"),cc.director.loadScene("Pass"))},checkPassGame:function(){var t=!0;return this.arr.forEach(function(o,n){o.val&&o.val!==n+1&&(t=!1)}),t},getSortArrs:function(t){for(var o=[],n=0;n<t;n++)o.push(n+1);return o.sort(function(t,o){return cc.random0To1()>.5?t-o:o-t}),o},_getSortArrs:function(t,o){for(var n=this,i=[],r=0;r<t-1;r++)i.push(r+1);i.push(null);for(var e=0;e<1e6;e++){var c=i.indexOf(null);if(e>o&&c===t-1)break;!function(o){var i=o.indexOf(null),r=null,e=[o[r=0===i?n.getRandomTarget([i+1,i+n.col]):i===n.col-1?n.getRandomTarget([i-1,i+n.col]):i===t-n.col?n.getRandomTarget([i+1,i-n.col]):i===t-1?n.getRandomTarget([i-1,i-n.col]):i<n.col-1?n.getRandomTarget([i+1,i-1,i+n.col]):(i+1)%n.col==0?n.getRandomTarget([i-1,i+n.col,i-n.col]):i>t-n.col?n.getRandomTarget([i+1,i-1,i-n.col]):i%n.col==0?n.getRandomTarget([i+1,i+n.col,i-n.col]):n.getRandomTarget([i+1,i-1,i+n.col,i-n.col])],o[i]];o[i]=e[0],o[r]=e[1]}(i)}return i},getRandom:function(t){return 0|cc.random0To1()*t},getRandomTarget:function(t){return t[this.getRandom(t.length)]}}),cc._RF.pop()},{}],pass:[function(t,o,n){"use strict";cc._RF.push(o,"d3bc5by3KVO679kLdRfbilc","pass"),cc.Class({extends:cc.Component,properties:{winMp3:{default:null,url:cc.AudioClip}},start:function(){cc.audioEngine.playEffect(this.winMp3)}}),cc._RF.pop()},{}]},{},["Game","Game2","btnClick","change","Global","huaGame","pass"]);