require=function t(i,o,n){function r(c,a){if(!o[c]){if(!i[c]){var s="function"==typeof require&&require;if(!a&&s)return s(c,!0);if(e)return e(c,!0);var l=new Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l}var h=o[c]={exports:{}};i[c][0].call(h.exports,function(t){var o=i[c][1][t];return r(o||t)},h,h.exports,t,i,o,n)}return o[c].exports}for(var e="function"==typeof require&&require,c=0;c<n.length;c++)r(n[c]);return r}({Game2:[function(t,i,o){"use strict";cc._RF.push(i,"78da29ONVVGYpDXBTrwqJtB","Game2");var n=t("./common/Global");cc.Class({extends:cc.Component,properties:{box:{default:null,type:cc.Prefab},picArrs:{default:[],type:[cc.SpriteFrame]},refreshBtn:{default:null,type:cc.Button},backBtn:{default:null,type:cc.Button}},onLoad:function(){var t=this;this.arr=[],this._boxArrs=[],this.selectId=null,this.clickId=null,this.pass=!1,this._lineNodes=[],this.row=n._type,this.col=n._type,this.gameStart(),this.refreshBtn.node.on(cc.Node.EventType.TOUCH_END,function(i){t.gameStart()}),this.backBtn.node.on(cc.Node.EventType.TOUCH_END,function(t){cc.director.loadScene("Began")})},gameStart:function(){var t=this;this._boxArrs.length>0&&(this._boxArrs.forEach(function(t){cc.isValid(t)&&t.destroy()}),this._boxArrs=[]);var i=this.picArrs.slice(0,this.row),o=cc.director.getWinSize().width,n=this.getSortArrs(i,this.row,this.col);if(0!==n.length){this._boxWidth=500/this.col;for(var r=0;r<this.row+2;r++)for(var e=0;e<this.col+2;e++){var c={point:[e,r],box:null,val:null,pos:null,index:e+r*(this.col+2)},a=-o/2+(o-this._boxWidth*this.col)/2+(e-.5)*this._boxWidth,s=270-(r-1)*this._boxWidth;if(c.pos=cc.p(a,s),0!==r&&0!==e&&r!==this.col+1&&e!==this.row+1){var l=e-1+(r-1)*this.col;c.val=n[l].type;var h=cc.instantiate(this.box);this.node.addChild(h);var u=new cc.Node;u.addComponent(cc.Sprite).spriteFrame=n[l].texture,h.addChild(u),h.setScale(this._boxWidth/h.width),h.setPosition(c.pos),h.setTag(c.index),c.box=h,this._boxArrs.push(h),h.on(cc.Node.EventType.TOUCH_END,function(i){var o=i.currentTarget.getTag();if(t.arr[o].box)if(t.selectId){if(o===t.selectId)return;t.clickId=o;var n=t.checkAction(t.arr[t.selectId],t.arr[o],!0);if(0==n.length)t.selectId=null;else{for(var r=0;r<n.length-1;r++)t.drawLine(n[r],n[r+1]);t.scheduleOnce(function(){t._lineNodes.forEach(function(t){t.clear()}),t.clickPass()},.3)}}else t.selectId=o,t.pass=!1,cc.log("selectId = ",t.arr[o].val)})}this.arr[c.index]=c}this.checkEnable()}},checkAction:function(t,i,o){var n=this;if(!this.checkDoublePass(t,i)&&o)return[];if((t.point[0]===i.point[0]||t.point[1]===i.point[1])&&this.checkDoublePoint(t,i))return[t,i];var r=this.getPointAround(t),e=this.getPointAround(i),c=null,a=!1;if(r.forEach(function(t){a||e.forEach(function(i){if(t.index===i.index)return c=t,void(a=!0)})}),c)return[t,c,i];var s=[];return r.forEach(function(o){n.pass||e.forEach(function(r){o.point[0]!==r.point[0]&&o.point[1]!==r.point[1]||!n.checkDoublePoint(o,r)||(n.pass=!0,s=[t,o,r,i])})}),s},checkDoublePass:function(t,i){return t.val===i.val},checkDoublePoint:function(t,i){if(t.point[0]===i.point[0])if(t.point[1]>i.point[1])for(var o=i.point[1]+1;o<t.point[1];o++){var n=t.point[0]+o*(this.row+2);if(this.arr[n].val)return!1}else for(var r=i.point[1]-1;r>t.point[1];r--){var e=t.point[0]+r*(this.row+2);if(this.arr[e].val)return!1}else if(t.point[0]>i.point[0])for(var c=i.point[0]+1;c<t.point[0];c++){var a=c+i.point[1]*(this.row+2);if(this.arr[a].val)return!1}else for(var s=i.point[0]-1;s>t.point[0];s--){var l=s+i.point[1]*(this.row+2);if(this.arr[l].val)return!1}return!0},getPointAround:function(t){for(var i=[],o=t.point[1]-1;o>=0;o--){var n=t.point[0]+o*(this.col+2);if(this.arr[n].val)break;i.push(this.arr[n])}for(var r=t.point[0]+1;r<this.col+2;r++){var e=r+t.point[1]*(this.col+2);if(this.arr[e].val)break;i.push(this.arr[e])}for(var c=t.point[1]+1;c<this.row+2;c++){var a=t.point[0]+c*(this.col+2);if(this.arr[a].val)break;i.push(this.arr[a])}for(var s=t.point[0]-1;s>=0;s--){var l=s+t.point[1]*(this.col+2);if(this.arr[l].val)break;i.push(this.arr[l])}return i},clickPass:function(){[this.arr[this.selectId],this.arr[this.clickId]].map(function(t){t.box.destroy(),t.box=null,t.val=null}),this.selectId=null,this.checkGameSuccess()},checkGameSuccess:function(){this.arr.every(function(t){return!t.box})?cc.director.loadScene("Pass"):this.checkEnable()},drawLine:function(t,i){var o=cc.director.getWinSize(),n=new cc.DrawNode;cc.Canvas.instance.node.parent._sgNode.addChild(n),n.drawSegment(cc.p(t.pos.x+o.width/2,t.pos.y+o.height/2),cc.p(i.pos.x+o.width/2,i.pos.y+o.height/2),5,cc.color(265,1,0,255)),this._lineNodes.push(n)},getSortArrs:function(t,i,o){var n=[],r=i*o/t.length;if(r.toString().indexOf(".")>=0||r%2!=0)return cc.log("随机图片的个数不平均"),n;for(var e=0;e<t.length;e++)for(var c=0;c<r;c++)n.push({type:e+1,texture:t[e]});return n.sort(function(t,i){return cc.random0To1()>.5?1:-1}),n},checkEnable:function(){0==this.findTip().length&&(cc.log("无解!!! 替换位置"),this.updateLayout())},findTip:function(){var t=this,i=[];this.arr.forEach(function(t){t.box&&(i[t.val]?i[t.val].push(t):i[t.val]=[t])});var o=!1,n=[];return i.forEach(function(i){if(!o)for(var r=0;r<i.length&&!o;r++)for(var e=r+1;e<i.length&&!o;e++){var c=t.checkAction(i[r],i[e],!0);c.length>0&&(o=!0,n=c)}}),n},updateLayout:function(){var t=this,i=!1;this.arr.forEach(function(o){if(!i&&o.box){var n=void 0,r=void 0;t.arr.forEach(function(i){if(i.box){n||o.val!==i.val||o.index===i.index||(n=i);var e=t.checkAction(o,i,!1);!r&&o.val!==i.val&&e.length>0&&(r=i)}}),n&&r&&(t.updateDoublePoint(n,r),i=!0)}})},updateDoublePoint:function(t,i){var o={val:t.val,box:t.box};t.val=i.val,t.box=i.box,i.val=o.val,i.box=o.box,[t,i].map(function(t){t.box.setTag(t.index),t.box.runAction(cc.moveTo(.3,t.pos))})}}),cc._RF.pop()},{"./common/Global":"Global"}],Game:[function(t,i,o){"use strict";cc._RF.push(i,"280c3rsZJJKnZ9RqbALVwtK","Game"),cc.Class({extends:cc.Component,properties:{box:{default:null,type:cc.Prefab},arr:{default:[]},row:4,col:4,selectId:null,clickId:null,pass:!1,passInfos:[],_lineNodes:[]},onLoad:function(){var t=[1,2,3,4],i=(this.row,this.col,cc.director.getWinSize().width),o=this.node.getChildByName("Background"),n=this.getSortArrs(t,this.row,this.col);if(0!==n.length){this._boxWidth=500/this.col;for(var r=this,e=0;e<this.row+2;e++)for(var c=0;c<this.col+2;c++){var a={point:[c,e],box:null,val:null,pos:null,index:c+e*(this.row+2)},s=(i-500)/2+(c-1)*this._boxWidth,l=750-(e-1)*this._boxWidth;if(a.pos=cc.p(s,l),0!==e&&0!==c&&e!==this.col+1&&c!==this.row+1){var h=c-1+(e-1)*this.row;a.val=n[h];var u=cc.instantiate(this.box);o.addChild(u),u.anchorX=0,u.anchorY=0;var d=u.getChildByName("label");d.setPosition(cc.p(u.width/2,u.height/2)),d.getComponent(cc.Label).string=a.val,u.setScale(this._boxWidth/u.width),u.setPosition(a.pos),u.setTag(a.index),a.box=u,u.on(cc.Node.EventType.TOUCH_END,function(t){t.currentTarget.getChildByName("label").getComponent(cc.Label).string;var i=t.currentTarget.getTag();if(r.arr[i].box)if(r.selectId){if(i===r.selectId)return;r.clickId=i,r.checkAction(r.arr[r.selectId],r.arr[i],0,[])}else r.selectId=i,r.pass=!1,cc.log("selectId = ",r.arr[i].val)})}this.arr.push(a)}}},checkAction:function(t,i,o,n){var r=n.slice();if(t.point[0]!==i.point[0]&&t.point[1]!==i.point[1]||!this.checkDoublePoint(t,i)){if(2!==o){r.push(t);var e=[],c=this;this.arr.forEach(function(i,o){(i.point[0]===t.point[0]&&o!==t.index&&!i.val||i.point[1]===t.point[1]&&o!==t.index&&!i.val)&&e.push(i)}),e=e.filter(function(i){if(c.checkDoublePoint(i,t))return i}),o++,e.forEach(function(t){c.checkAction(t,i,o,r)}),1===o&&(cc.log("所有情况跑完"),this.findShortPath())}}else this.checkDoublePass(this.arr[this.selectId],this.arr[this.clickId])?(r.push(t),r.push(i),this.addPassInfo(r),0==o&&this.findShortPath()):0===o&&(this.selectId=null)},checkDoublePass:function(t,i){return t.val===i.val},checkDoublePoint:function(t,i){if(t.point[0]===i.point[0])if(t.point[1]>i.point[1])for(o=i.point[1]+1;o<t.point[1];o++){n=t.point[0]+o*(this.row+2);if(this.arr[n].val)return!1}else for(o=i.point[1]-1;o>t.point[1];o--){n=t.point[0]+o*(this.row+2);if(this.arr[n].val)return!1}else if(t.point[0]>i.point[0])for(o=i.point[0]+1;o<t.point[0];o++){n=o+i.point[1]*(this.row+2);if(this.arr[n].val)return!1}else for(var o=i.point[0]-1;o>t.point[0];o--){var n=o+i.point[1]*(this.row+2);if(this.arr[n].val)return!1}return!0},addPassInfo:function(t){this.passInfos.push(t)},findShortPath:function(){if(this.passInfos.length<=0)return cc.log("没有符合条件!!!"),void(this.selectId=null);var t=null,i=0;this.passInfos.forEach(function(o){for(var n=0,r=1;r<o.length;r++){var e=o[r].point,c=o[r-1].point;e[0]===c[0]?n+=Math.abs(e[1]-c[1]):n+=Math.abs(e[0]-c[0])}(n<i||!i)&&(t=o,i=n)});for(var o=0;o<t.length-1;o++)this.drawLine(t[o],t[o+1]);this.scheduleOnce(function(){this._lineNodes.forEach(function(t){t.clear()}),this.gamePass()},.5)},gamePass:function(){var t=this.arr[this.selectId],i=this.arr[this.clickId];t.box.destroy(),t.box=null,t.val=null,i.box.destroy(),i.box=null,i.val=null,this.selectId=null,this.pass=!0,this.passInfos=[],this.checkGameSuccess()},checkGameSuccess:function(){this.arr.every(function(t){return!t.box})&&(cc.log("通关"),cc.director.loadScene("Pass"))},drawLine:function(t,i){var o=new cc.DrawNode;cc.Canvas.instance.node.parent._sgNode.addChild(o,100),o.drawSegment(cc.p(t.pos.x+this._boxWidth/2+5,t.pos.y+this._boxWidth/2),cc.p(i.pos.x+this._boxWidth/2+5,i.pos.y+this._boxWidth/2),5,cc.color(265,1,0,255)),this._lineNodes.push(o)},getSortArrs:function(t,i,o){var n=[],r=i*o/t.length;if(r.toString().indexOf(".")>=0||r%2!=0)return cc.log("随机图片的个数不平均"),n;for(var e=0;e<t.length;e++)for(var c=0;c<r;c++)n.push(t[e]);return n.sort(function(t,i){return cc.random0To1()>.5?1:-1}),n},update:function(t){}}),cc._RF.pop()},{}],Global:[function(t,i,o){"use strict";cc._RF.push(i,"a0d74w6/RlD6pPIwyfKLFp/","Global"),i.exports={_type:4},cc._RF.pop()},{}],XXLGame:[function(t,i,o){"use strict";cc._RF.push(i,"40905aYvSpOub3AGKKpSVD3","XXLGame");var n=t("./Game2");cc.Class({extends:n,properties:{showTip:cc.Sprite},onLoad:function(){this.row=12,this.col=12,this._probability=.008,this.arr=[]},start:function(){this.showTip.getComponent(cc.Sprite).node.active=!1,this.showTip.getComponent(cc.Sprite).node.setLocalZOrder(100);var t=cc.director.getWinSize();if(this._arrs=this.getSortArrs(this.picArrs.slice(0,6),this.row,this.col),0!==this._arrs.length){this._boxWidth=t.width/this.col;for(var i=0;i<this.row;i++)for(var o=0;o<this.col;o++){var n={point:[o,i],box:null,val:null,pos:null,isValid:!0,index:o+i*this.col},r=-t.width/2+(t.width-this._boxWidth*this.col)/2+(o+.5)*this._boxWidth,e=270-i*this._boxWidth;n.pos=cc.p(r,e);var c=n.index;n.val=this._arrs[c].type;var a=this.newBox(n.val-1);a.setPosition(n.pos),a.setTag(n.index),n.box=a,this.arr[n.index]=n}}},getAroundPoints:function(t){var i=[];if(!t.isValid)return i;var o=this.arr[t.index-1];o&&o.box&&o.isValid&&0!==t.point[0]&&o.val===t.val&&i.push(o);var n=this.arr[t.index+1];n&&n.box&&n.isValid&&t.point[0]!==this.col-1&&n.val===t.val&&i.push(n);var r=this.arr[t.index-this.col];r&&r.box&&r.isValid&&0!==t.point[1]&&r.val===t.val&&i.push(r);var e=this.arr[t.index+this.col];return e&&e.box&&e.isValid&&t.point[1]!==this.row-1&&e.val===t.val&&i.push(e),i},getChunk:function(t,i,o,n){var r=this;if(n){if(9===t.val){for(var e=0;e<this.row;e++){var c=t.point[0]+e*this.col;this.arr[c].box&&o.push(this.arr[c])}return o}if(10===t.val){for(var a=0;a<this.col;a++){var s=a+this.col*t.point[1];this.arr[s].box&&o.push(this.arr[s])}return o}}return[t].concat(this.getAroundPoints(t)).forEach(function(t){i.indexOf(t.index)<0&&(i.push(t.index),o.push(t),o.concat(r.getChunk(t,i,o,!1)))}),o},clearPoints:function(t){var i=this,o={};t.forEach(function(t){var i=o[t.point[0]];i?t.index>i.maxIdx&&(i.maxIdx=t.index):i={maxIdx:t.index},t.box.destroy(),t.box=null,t.val=null,o[t.point[0]]=i});for(var n in o){for(var r=o[n].maxIdx,e=[],c=0;c<this.row;c++){var a=parseInt(n)+c*this.col;this.arr[a]&&a<r&&e.push(this.arr[a])}this.movePoints(e,r)}this.scheduleOnce(function(){i.checkClickEnable()},.3)},movePoints:function(t,i){for(var o=t.length-1;o>=0;o--){for(var n=t[o],r=0,e=n.point[1]+1;e<this.row;e++){var c=n.point[0]+e*this.col;this.arr[c].box||r++}var a=n.index+this.col*r,s=this.arr[a];s.val=n.val,s.box=n.box,s.box&&(s.box.setTag(s.index),s.box.runAction(cc.moveTo(.2,s.pos))),n.val=null,n.box=null}},checkClickEnable:function(){var t=this,i=!1;this.arr.forEach(function(o){if(o.box){var n=t.getAroundPoints(o);if(9===o.val||10===o.val||n.length>0)return void(i=!0)}}),i||(this.setDisable(),this.arr.every(function(t){return t.box})?this.gameOver():this.setNextRound())},setDisable:function(){this.arr.forEach(function(t){t.box&&(t.isValid=!1,t.box._spNode.setColor(cc.color(150,150,150)))})},setNextRound:function(){var t=this,i={};this.arr.forEach(function(t){if(!t.box){var o=i[t.point[0]];o?(o.count+=1,t.point[1]>o.maxY&&(o.maxY=t.point[1]),o.points.unshift(t)):o={count:1,maxY:t.point[1],points:[t]},i[t.point[0]]=o}});for(var o in i)this.createColBox(o,i[o]);this.scheduleOnce(function(){t.checkClickEnable()},.3)},createColBox:function(t,i){for(var o=i.count,n=(i.maxY,i.points),r=0;r<o;r++){var e=cc.random0To1(),c=void 0;c=e<this._probability?8:e>this._probability&&e<2*this._probability?9:0|cc.random0To1()*(this.picArrs.length-2);var a=this.newBox(c),s=this.arr[t];a.setPosition(cc.p(s.pos.x,s.pos.y+this._boxWidth*(r+1)));var l=n[r];a.setTag(l.index),l.box=a,l.val=c+1,l.isValid=!0,a.runAction(cc.moveTo(.2,l.pos))}},newBox:function(t){var i=this,o=cc.instantiate(this.box);this.node.addChild(o);var n=new cc.Node;return n.addComponent(cc.Sprite).spriteFrame=this.picArrs[t],o._spNode=n,o.addChild(n),o.setScale(this._boxWidth/o.width),o.on(cc.Node.EventType.TOUCH_END,function(t){var o=t.currentTarget.getTag();if(i.arr[o].box){var n=i.arr[o];if(n.isValid&&n.box){var r=i.getChunk(n,[],[],!0);r.length>1&&i.clearPoints(r)}}}),o},gameOver:function(){cc.log("游戏结束"),this.showTip.getComponent(cc.Sprite).node.active=!0}}),cc._RF.pop()},{"./Game2":"Game2"}],btnClick:[function(t,i,o){"use strict";cc._RF.push(i,"b2cdcGTZK5G54EVIt5boJDs","btnClick");var n=t("./common/Global");cc.Class({extends:cc.Component,properties:{btnMp3:{default:null,url:cc.AudioClip}},start:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(i){t.btnClick()},this)},btnClick:function(t){cc.audioEngine.playEffect(this.btnMp3)},click:function(t){cc.director.loadScene("Change")},typeClick:function(t,i){n._type=+i,cc.director.loadScene("Game")},gobackClick:function(){cc.director.loadScene("Change")},xxlGobackClick:function(){cc.director.loadScene("Change")},changeGameClick:function(t,i){this.btnClick(),"lianliankan"===i?cc.director.loadScene("Began"):"huarongdao"===i?cc.director.loadScene("HuaGame"):"xiaoxiaole"===i&&cc.director.loadScene("XXLGame")}}),cc._RF.pop()},{"./common/Global":"Global"}],change:[function(t,i,o){"use strict";cc._RF.push(i,"bfcbaZM+WBK4IM5fbWkzsfL","change"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.director.preloadScene("Began"),cc.director.preloadScene("HuaGame")},start:function(){}}),cc._RF.pop()},{}],huaGame:[function(t,i,o){"use strict";cc._RF.push(i,"c3c04KhgWdFG54kGnB/L2Jt","huaGame"),cc.Class({extends:cc.Component,properties:{box:{default:null,type:cc.Prefab},arr:{default:[]}},ctor:function(){this.col=4,this.row=4},onLoad:function(){for(var t=this,i=this.row,o=this.col,n=i*o,r=this._getSortArrs(n,2e3),e=500/o,c=0;c<n;c++){var a=(c%o-o/2+.5)*e,s=200-Math.floor(c/o)*e;this.arr[c]={point:[c%o,Math.floor(c/o)],val:null,box:null,pos:cc.p(a,s)}}for(var l=0;l<n-1;l++){var h=cc.instantiate(this.box);this.node.addChild(h),h.getChildByName("label").getComponent(cc.Label).string=r[l],h.setScale(e/h.width),this.arr[l].val=r[l],this.arr[l].box=h,h.setPosition(this.arr[l].pos),h.on("mousedown",function(n){var r=+n.currentTarget.getChildByName("label").getComponent(cc.Label).string,e=void 0,c=void 0;t.arr.forEach(function(t,i){if(r===t.val)return e=t,void(c=i)});var a=[[e.point[0],e.point[1]-1],[e.point[0]+1,e.point[1]],[e.point[0],e.point[1]+1],[e.point[0]-1,e.point[1]]],s=c,l=void 0;a.forEach(function(n){var r=n[0]+n[1]*o;0<=n[0]&&n[0]<o&&0<=n[1]&&n[1]<i&&!t.arr[r].val&&(l=r)}),l>=0&&t.runAction(s,l)})}},runAction:function(t,i){var o=this.arr[i],n=this.arr[t];o.box=n.box,o.val=n.val,o.box.runAction(cc.moveTo(.1,o.pos)),this.arr[t].val=null,this.arr[t].box=null,this.checkPassGame()&&(cc.log("YOU WIN!! GAME OVER!"),cc.director.loadScene("Pass"))},checkPassGame:function(){var t=!0;return this.arr.forEach(function(i,o){i.val&&i.val!==o+1&&(t=!1)}),t},getSortArrs:function(t){for(var i=[],o=0;o<t;o++)i.push(o+1);return i.sort(function(t,i){return cc.random0To1()>.5?t-i:i-t}),i},_getSortArrs:function(t,i){for(var o=this,n=[],r=0;r<t-1;r++)n.push(r+1);n.push(null);for(var e=0;e<1e6;e++){var c=n.indexOf(null);if(e>i&&c===t-1)break;!function(i){var n=i.indexOf(null),r=null,e=[i[r=0===n?o.getRandomTarget([n+1,n+o.col]):n===o.col-1?o.getRandomTarget([n-1,n+o.col]):n===t-o.col?o.getRandomTarget([n+1,n-o.col]):n===t-1?o.getRandomTarget([n-1,n-o.col]):n<o.col-1?o.getRandomTarget([n+1,n-1,n+o.col]):(n+1)%o.col==0?o.getRandomTarget([n-1,n+o.col,n-o.col]):n>t-o.col?o.getRandomTarget([n+1,n-1,n-o.col]):n%o.col==0?o.getRandomTarget([n+1,n+o.col,n-o.col]):o.getRandomTarget([n+1,n-1,n+o.col,n-o.col])],i[n]];i[n]=e[0],i[r]=e[1]}(n)}return n},getRandom:function(t){return 0|cc.random0To1()*t},getRandomTarget:function(t){return t[this.getRandom(t.length)]}}),cc._RF.pop()},{}],pass:[function(t,i,o){"use strict";cc._RF.push(i,"d3bc5by3KVO679kLdRfbilc","pass"),cc.Class({extends:cc.Component,properties:{winMp3:{default:null,url:cc.AudioClip}},start:function(){cc.audioEngine.playEffect(this.winMp3)}}),cc._RF.pop()},{}]},{},["Game","Game2","XXLGame","btnClick","change","Global","huaGame","pass"]);